<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Purchase</title>
</head>
<body>

<script>
// Push kundenummer til dataLayer
window.dataLayer = window.dataLayer || [];
dataLayer.push({
  'uid': 'refundCustomer_12345'
});
</script>

<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-TDMCBQ3"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TDMCBQ3');</script>
<!-- End Google Tag Manager -->

<h1>Purchase</h1>

<script>

function getParameterByName(name, url) {
    if (!url) {
      url = window.location.href;
    }
    name = name.replace(/[\[\]]/g, "\\$&");
    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, " "));
}

var transactionId = getParameterByName('tid');
var refund = getParameterByName('refund');
var text = "Normal purchase";

console.log(refund);

var price = (refund === "yes") ? transactionId * -1 : transactionId;

console.log(price);

window.dataLayer = window.dataLayer || []
dataLayer.push({
   'event': 'purchaseClassic',
   'transactionId': transactionId,
   'transactionAffiliation': 'Affiliation',
   'transactionTotal': price,
   'transactionTax': price * 0.2,
   'transactionShipping': price / 100,
   'transactionProducts': [{
       'sku': transactionId,
       'name': text + ' product',
       'category': '',
       'price': price,
       'quantity': 1
   }]
});
</script>
	
</body>
</html>